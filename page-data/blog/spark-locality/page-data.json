{"componentChunkName":"component---src-templates-blog-js","path":"/blog/spark-locality","result":{"data":{"markdownRemark":{"frontmatter":{"title":"Data Locality in Spark","date":"2019-05-12"},"html":"<p>This post provides an overview of different types of data locality in Spark. In the coming posts, we'll dive deeper into more low-level concepts. Meaning, we'll explore the Spark internals using examples. Then, we'll explore some examples of running spark applications in a cluster with a <a href=\"/blog/spark-standalone/\">standalone</a> cluster manager, <a href=\"/blog/spark-yarn/\">YARN</a> cluster manager, and <a href=\"/blog/spark-mesos/\">Mesos</a> cluster manager.</p>\n<h2>Defining Data Locality</h2>\n<p>In Spark, tasks are run as close to the location of data as possible. Meaning, executors are selected based on their proximity to requested data within the cluster. This notion is referred to as <em>data locality</em>. Since the selection of executors is affected, data locality influences job scheduling as a consequence. To find optimal executors closest to the data, Spark maintains a list of preferred executors for each partition.</p>\n<p>Data locality can have a major impact on the performance of Spark jobs. If data and the code operating on it are together, then computation tends to be fast. The goal of data locality is to minimize the read and write speed from the CPU to memory. Data locality is achieved if each HDFS block is loaded in the RAM of the same node where the HDFS block lives. Specifically, data transfer can be avoided if the Spark scheduler runs tasks on executors where these blocks are present.</p>\n<h2>Levels of Data Locality</h2>\n<p>The locality level indicates which type of data access is performed. There are five levels of data locality:</p>\n<ol>\n<li>\n<p><code class=\"language-text\">PROCESS_LOCAL</code></p>\n<ul>\n<li>Execute a task on the same executor as the cached data</li>\n</ul>\n</li>\n<li>\n<p><code class=\"language-text\">NODE_LOCAL</code></p>\n<ul>\n<li>Execute a task on the same node as the cached data, but on different executors</li>\n<li>Generally, this level is slower than the previous one</li>\n<li>However, sometimes there is waiting for available executors</li>\n</ul>\n</li>\n<li>\n<p><code class=\"language-text\">RACK_LOCAL</code></p>\n<ul>\n<li>Execute a task on the same rack as the cached data, but on different executors and nodes</li>\n<li>Generally, this level is even slower</li>\n<li>This is because even more data is moved through the network</li>\n</ul>\n</li>\n<li>\n<p><code class=\"language-text\">NO_PREF</code></p>\n<ul>\n<li>There isn't any preference for data locality</li>\n</ul>\n</li>\n<li>\n<p><code class=\"language-text\">ANY</code></p>\n<ul>\n<li>Execute a task on any executor on any rack, node, or executor</li>\n</ul>\n</li>\n</ol>"}},"pageContext":{"slug":"spark-locality"}},"staticQueryHashes":["2961437231","3159585216"]}