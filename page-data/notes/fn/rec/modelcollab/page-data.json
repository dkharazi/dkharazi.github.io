{"componentChunkName":"component---src-templates-entry-js","path":"/notes/fn/rec/modelcollab","result":{"data":{"markdownRemark":{"frontmatter":{"title":"Model-Based Collab Filtering"},"html":"<h3>Introducing Recommendation Systems</h3>\n<ul>\n<li>\n<p>The goal of any recommender system is to do the following:</p>\n<ul>\n<li>Predict the ratings that a certain user would give to different catalog items</li>\n<li>Create a list of recommendations by selecting</li>\n<li>Rank those items with the highest predicted ratings</li>\n</ul>\n</li>\n<li>Collaborative filtering is used for creating recommendation systems</li>\n</ul>\n<h3>Introducing Collaborative Filtering</h3>\n<ul>\n<li>Under the hood, collaborative filtering uses a predictive model to predict a rating for a given pair of user and item</li>\n<li>These predictions are based on how similar users rate similar items</li>\n<li>Specifically, the model captures interactions between known users and items from the rating matrix</li>\n<li>The benefit of collaborative filtering is that they're capable of making recommendations based only on the patterns and similarities available in the rating matrix</li>\n<li>\n<p>It has the following disadvantages:</p>\n<ul>\n<li>Difficult to build reliable rating predictions if matrix is too sparse</li>\n<li>Difficult to handle new users or items (cold start problem)</li>\n<li>Somewhat biased towards popular items (difficult to pick up on unusual tastes)</li>\n</ul>\n</li>\n</ul>\n<h3>Defining Types of Collaborative Filtering</h3>\n<ul>\n<li>\n<p>Collaborative filtering algorithms are usually categorized into two subgroups:</p>\n<ul>\n<li>Neighborhood-based methods</li>\n<li>Model-based methods</li>\n</ul>\n</li>\n<li>\n<p>Neighborhood-based methods predict unknown ratings for a given user or item by doing the following:</p>\n<ul>\n<li>Finding the most similar known users or items</li>\n<li>Averaging ratings from their records</li>\n</ul>\n</li>\n<li>\n<p>Model-based methods go beyond the nearest neighbor approach</p>\n<ul>\n<li>Specifically, they use more sophisticated, predictive models</li>\n</ul>\n</li>\n</ul>\n<h3>Introducing Model-Based Collaborative Filtering</h3>\n<ul>\n<li>\n<p>Often, a neighborhood-based algorithm does the following:</p>\n<ul>\n<li>Optionally, impute missing data (using neighborhood or model based methods)</li>\n<li>Computes the similarity between each user and item</li>\n<li>Optionally, group similar users beforehand using locality-sensitive hashing</li>\n<li>Predict the rating of a user and item by calculating the weighted average of the <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span> nearest neighbors</li>\n</ul>\n</li>\n<li>\n<p>Often, a model-based algorithm does the following instead:</p>\n<ul>\n<li>Optionally, impute missing data (using neighborhood or model based methods)</li>\n<li>\n<p>Compute latent factors by performing matrix factorization (using SVD or PCA)</p>\n<ul>\n<li>Naturally, this will act as a form of dimensionality reduction</li>\n</ul>\n</li>\n<li>Predict the rating of a user and item wtih matrix multiplication of latent factors</li>\n</ul>\n</li>\n</ul>\n<h3>Introducing Matrix Factorization</h3>\n<ul>\n<li>Matrix factorization (or latent factor models) are the most popular model-based method</li>\n<li>\n<p>The following are popular forms of matrix factorization:</p>\n<ul>\n<li>\n<p>Unconstrained matrix factorization (or funk MF)</p>\n<ul>\n<li>Optimization using stochastic gradient descent (SGD)</li>\n<li>Optimization using alternating least squares (ALS)</li>\n</ul>\n</li>\n<li>Singular value decomposition (SVD)</li>\n<li>Non-negative matrix factorization</li>\n</ul>\n</li>\n<li>\n<p>Most matrix factorization methods follow these steps:</p>\n<ul>\n<li>Receive defined model of matrices</li>\n<li>Define the objective function</li>\n<li>Optimize with gradient descent</li>\n</ul>\n</li>\n</ul>\n<h3>Advantages of Model-Based Collaborative Filtering</h3>\n<ul>\n<li>\n<p>This approach offers the following advantages over neighborhood-based methods:</p>\n<ul>\n<li>\n<p><strong>Accuracy</strong></p>\n<ul>\n<li>There are more accurate models compared to kNN</li>\n</ul>\n</li>\n<li>\n<p><strong>Stability</strong></p>\n<ul>\n<li>Offers dimensionality reduction methods</li>\n<li>Thus, sparse matrices can be transformed into more condensed representations</li>\n<li>This improves the stability of predictions</li>\n</ul>\n</li>\n<li>\n<p><strong>Scalability</strong></p>\n<ul>\n<li>Models can be trained offline</li>\n<li>Then, these models can be evaluated for online requests</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p>Some model-based methods can provide all of these improvements</p>\n<ul>\n<li>Others can only provide some of them</li>\n</ul>\n</li>\n</ul>\n<h3>Defining Singular Value Decomposition</h3>\n<ul>\n<li>\n<p>Again, the rating matrix <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>R</mi></mrow><annotation encoding=\"application/x-tex\">R</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span></span></span></span> consists of:</p>\n<ul>\n<li>A <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span> number of rows representing individual users</li>\n<li>A <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.65952em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> number of columns representing individual items</li>\n<li>Each entry represents a rating</li>\n</ul>\n</li>\n<li>\n<p>Latent factor models decompose the ratings matrix into:</p>\n<ul>\n<li>A <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo>×</mo><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">u \\times k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.66666em;vertical-align:-0.08333em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span> user matrix <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>U</mi></mrow><annotation encoding=\"application/x-tex\">U</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span></span></span></span></li>\n<li>A <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi><mo>×</mo><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">k \\times i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.77777em;vertical-align:-0.08333em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.65952em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> item matrix <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>I</mi></mrow><annotation encoding=\"application/x-tex\">I</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span></span></span></span></li>\n<li>\n<p>A <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi><mo>×</mo><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k \\times k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.77777em;vertical-align:-0.08333em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span> weight matrix <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">Σ</mi></mrow><annotation encoding=\"application/x-tex\">\\Sigma</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord\">Σ</span></span></span></span></p>\n<ul>\n<li>Essentially, this represents a matrix denoting which <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>k</mi><mrow><mi>t</mi><mi>h</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">k^{th}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.849108em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.849108em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mathnormal mtight\">h</span></span></span></span></span></span></span></span></span></span></span></span> latent factor carriest most of the information</li>\n<li>Or, each value located in the diagonal of the matrix represents the strength of the <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>k</mi><mrow><mi>t</mi><mi>h</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">k^{th}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.849108em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.849108em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mathnormal mtight\">h</span></span></span></span></span></span></span></span></span></span></span></span> latent factor</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>Here, <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span> is the number of users in our rating matrix</li>\n<li>Here, <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.65952em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> is the number of items in our rating matrix</li>\n<li>\n<p>Here, <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span> is the number of latent factors</p>\n<ul>\n<li>Each latent factor represents some learned context</li>\n<li>Increasing the number of latent factors improves personalization</li>\n<li>Increasing the number of latent factors by too much harms performance and leads to overfitting</li>\n<li>Typically, a regularization term is introduced to avoid overfitting</li>\n</ul>\n</li>\n</ul>\n<p><img src=\"/ea1a1188ed0699c8e26f95df5e67b88a/svd.svg\" alt=\"svd\"></p>\n<h3>Illustrating Latent Factor Models</h3>\n<ul>\n<li>Suppose we have a ratings matrix <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>R</mi></mrow><annotation encoding=\"application/x-tex\">R</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span></span></span></span> consisting of customers and movies</li>\n<li>For this example, we'll assign the number of latent factors <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span> to equal <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">2</span></span></span></span></li>\n<li>Thus, we'll learn two different types of <em>context</em> from our customers <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>U</mi></mrow><annotation encoding=\"application/x-tex\">U</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span></span></span></span> and movies <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>I</mi></mrow><annotation encoding=\"application/x-tex\">I</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span></span></span></span></li>\n<li>\n<p>Notice, our optimization algorithm will learn <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">2</span></span></span></span> different contexts:</p>\n<ul>\n<li>The degree to which a movie is meant for children or a customer is a child</li>\n<li>The degree to which a movie is a blockbuster of a customer enjoys blockbuster movies</li>\n</ul>\n</li>\n<li>The following image illustrates the learned latent factors:</li>\n</ul>\n<p><img src=\"/fa1b50041754b2b9937c920733cec41c/latentfactors.svg\" alt=\"latentfactors\"></p>\n<h3>References</h3>\n<ul>\n<li><a href=\"https://www.cs.cmu.edu/~mgormley/courses/10601-s17/slides/lecture25-mf.pdf\" target=\"_blank\" rel=\"nofollow\">Slides for Latent Factor Models</a></li>\n<li><a href=\"https://spark.apache.org/docs/2.2.0/ml-collaborative-filtering.html\" target=\"_blank\" rel=\"nofollow\">Alternating Least Squares with Spark</a></li>\n<li><a href=\"https://towardsdatascience.com/building-a-collaborative-filtering-recommender-system-with-clickstream-data-dffc86c8c65\" target=\"_blank\" rel=\"nofollow\">Collaborative Filtering with Implicit Feedback</a></li>\n<li><a href=\"https://algorithmicweb.files.wordpress.com/2018/07/algorithmic-marketing-ai-for-marketing-operations-r1-7g.pdf\" target=\"_blank\" rel=\"nofollow\">Textbook about Algorithmic Marketing</a></li>\n<li><a href=\"https://databricks.com/blog/2020/12/18/personalizing-the-customer-experience-with-recommendations.html\" target=\"_blank\" rel=\"nofollow\">Personalizing Experience with Callaborative Filtering</a></li>\n<li><a href=\"https://realpython.com/build-recommendation-engine-collaborative-filtering/\" target=\"_blank\" rel=\"nofollow\">Building Recommendation Systems in Python</a></li>\n<li><a href=\"http://cs229.stanford.edu/proj2007/Dommeti-NeighborhoodBasedMethodsForCollaborativeFiltering.pdf\" target=\"_blank\" rel=\"nofollow\">Paper about Collaborative Filtering Methods</a></li>\n<li><a href=\"https://developers.google.com/machine-learning/recommendation/collaborative/basics\" target=\"_blank\" rel=\"nofollow\">Google Course about Basics of Collaborative Fitlering</a></li>\n</ul>"}},"pageContext":{"slug":"fn/rec/modelcollab","previousSlug":"fn/rec/neighborcollab","nextSlug":"fn/rec/hybrid","previousTitle":"Neighborhood-Based Collab Filtering","nextTitle":"Hybrid Filtering Methods"}},"staticQueryHashes":[]}