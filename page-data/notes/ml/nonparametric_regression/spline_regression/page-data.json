{"componentChunkName":"component---src-templates-entry-js","path":"/notes/ml/nonparametric_regression/spline_regression","result":{"data":{"markdownRemark":{"frontmatter":{"title":"Spline Regression"},"html":"<h3>Describing Spline Regression</h3>\n<ul>\n<li>Spline regression is a regression technique that involves dividing the dataset into multiple bins and fitting each bin with a separate model</li>\n<li>In polynomial regression, we generate new features by using various polynomial functions on the existing features, which imposed a global structure on the dataset</li>\n<li>Spline regression, however, uses piecewise functions to divide the distribution of data into different bins and fits linear or low-degree polynomial functions on each of these portions, which gives it its non-local property</li>\n</ul>\n<h3>Basics of Piecewise Functions</h3>\n<ul>\n<li>A function which we can use for modeling an individual bin is known as a piecewise function</li>\n<li>Said another way, a piecewise function is a function that is applied to an individual bin for some input variable</li>\n<li>The points where these divisions occur are called knots</li>\n</ul>\n<h3>Piecewise Step Functions</h3>\n<ul>\n<li>A common type of piecewise function is a step function</li>\n<li>A piecewise step function is a function that remains constant within a single interval (or bin)</li>\n<li>In other words, we can break the range of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi></mrow><annotation encoding=\"application/x-tex\">X</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span></span></span></span> into bins and fit a different constant to each bin</li>\n<li>Piecewise step functions don't capture any rate of change (slope=0) across its bin, meaning there isn't any relationship between the input and output for each individual bin</li>\n<li>In other words, a piecewise step function won't capture any trend in its bin, which is clearly a problem</li>\n</ul>\n<h3>Piecewise Linear Functions</h3>\n<ul>\n<li>Another common type of piecewise function is a linear function</li>\n<li>A piecewise linear function is a function that has a constant rate of change within a single interval (or bin)</li>\n<li>In other words, we can break the range of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi></mrow><annotation encoding=\"application/x-tex\">X</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span></span></span></span> into bins and fit a different linear model to each bin</li>\n<li>Piecewise linear functions don't capture any non-linear relationships across its bin</li>\n<li>In other words, a piecewise linear function won't capture any non-linear trend in its bin, which is clearly a problem if our predictor and response variables follow a non-linear relationship</li>\n</ul>\n<h3>Piecewise Polynomial Functions</h3>\n<ul>\n<li>Another common type of piecewise function is a polynomial function</li>\n<li>Polynomial regression involves fitting separate low-degree polynomials over different regions</li>\n<li>A piecewise polynomial function is a function that has a non-constant rate of change within a single interval (or bin)</li>\n<li>In other words, we can break the range of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi></mrow><annotation encoding=\"application/x-tex\">X</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span></span></span></span> into bins and fit a different polynomial model to each bin</li>\n<li>Piecewise polynomial functions capture non-linear relationships across its bin</li>\n<li>\n<p>Piecewise polynomial functions provides a very flexible fit to the data because of two reasons:</p>\n<ol>\n<li>Polynomial functions with higher degrees become more flexible, since we are allowing for more <em>humps</em> to be fit to the data</li>\n<li>Piecewise functions with more knots become more flexible, since we are able to use different functions for every bin</li>\n</ol>\n</li>\n<li>Therefore, we need to be careful about overfitting the training data, due to the increased flexibility</li>\n</ul>\n<h3>Constraints and Splines</h3>\n<ul>\n<li>The issue with piecewise functions (without certain constraints) is they are not continuous at their knots</li>\n<li>\n<p>Therefore, we need to add the following constraints to ensure a smooth, continuous transition between each piecewise function at their knots:</p>\n<ol>\n<li>\n<p>Add a constraint so polynomials (or other functions) are continuous on each side of the knot</p>\n<ul>\n<li>Without this constraint, there will be two different values assigned to each knot for different piecewise functions</li>\n<li>Therefore, we can achieve continuity by adding a constraint to ensure there is only one unique value assigned to each knot before fitting the polynomial functions for each bin</li>\n<li>Then, the polynomial models will ensure continuity when using least squares for fitting</li>\n</ul>\n</li>\n<li>\n<p>Add a constraint so polynomials are smooth on each side of the knot</p>\n<ul>\n<li>Without this constraint, there will be unexpected, choppy transitions between each knot</li>\n<li>Therefore, we can achieve smoothness by adding a constraint to ensure the first derivative of both the polynomials are equal before fitting the polynomial functions for each bin</li>\n<li>Then, the polynomial models will ensure smoothness when using least squares for fitting</li>\n</ul>\n</li>\n<li>\n<p>Add a constraint so polynomials are even more smooth on each side of the knot</p>\n<ul>\n<li>Without this constraint, there will be some remaining choppy transitions between each knot</li>\n<li>Therefore, we can achieve further smoothness by adding a constraint to ensure the second derivative of both the polynomials are equal before fitting the polynomial functions for each bin</li>\n<li>Then, the polynomial models will ensure further smoothness when using least squares for fitting</li>\n<li>As a result, we are also able to use fewer degrees of freedom, which simplifies our model</li>\n<li>We can also continue to remove degrees of freedom by ensuring the next (third, fourth, etc.) derivatives are equal, but we rarely find it useful to go beyond cubic splines (since they are typically flexible enough)</li>\n</ul>\n</li>\n</ol>\n</li>\n<li>A piecewise cubic function with the above contraints met is called a spline</li>\n<li>Specifically, a piecewise polynomial function of degree m with m-1 continuous derivatives is called a spline</li>\n<li>For example, if we fit a piecewise cubic function to a bin with the three contraints met, our piecewise cubic function is known as a cubic spline</li>\n</ul>\n<h3>Natural Splines</h3>\n<ul>\n<li>The degrees of freedom associated with cubic splines can still be reduced even further</li>\n<li>More importantly, the cubic splines fit around the boundaries of the knots still behave erratically</li>\n<li>\n<p>Therefore, we need to add another constraint to ensure even smoother splines:</p>\n<ol>\n<li>\n<p>Add a constraint so polynomials are even smoother on the boundaries of knots</p>\n<ul>\n<li>Without this constraint, there will be some remaining erratic behavior near the boundaries of the data (i.e. the furthest points where knots do not overlap)</li>\n<li>Therefore, we can achieve even further smoothness by adding a constraint to ensure the piecewise functions containing the knots on the boundaries are linear</li>\n<li>Then, the polynomial model will ensure even further smoothness when using least squares for fitting</li>\n</ul>\n</li>\n</ol>\n</li>\n<li>A cubic spline function with the above constraint met is called a natural cubic spline</li>\n</ul>\n<h3>Choosing the Number and Location of Knots</h3>\n<ul>\n<li>Most common approach: place a reasonable number of knots at uniform quantiles across the data</li>\n<li>Most effective approach: place knots across the data in areas of high variability, and validate the number and locations of these knots using cross-validation</li>\n</ul>\n<h3>Comparison of Polynomial Regression and Spline Regression</h3>\n<ol>\n<li>\n<p>A drawback of polynomial regression is that the function only captures global trends between a response variable and a predictor variable</p>\n<ul>\n<li>In other words, polynomial regression is non-local, meaning that the fitted value of y at a given data point strongly depends on other data values far away from that data point</li>\n<li>Spline regression, on the other hand, is local</li>\n<li>Therefore, spline regression can be a useful regression alternative to polynomial regression</li>\n</ul>\n</li>\n<li>\n<p>A drawback of polynomial regression is that polynomials must increase the degree of polynomial to increase flexibility in the model, meaning they must increase their degrees of freedom as well</p>\n<ul>\n<li>Said another way, polynomials must use a high degree polynomial to produce flexible fits</li>\n<li>Spline regression, on the other hand, introduces flexibility by increasing the number of knots, which keeps the degrees of freedom fixed</li>\n<li>Therefore, spline regression can be a useful regression alternative to polynomial regression</li>\n</ul>\n</li>\n</ol>\n<h3>References</h3>\n<ul>\n<li><a href=\"https://www.analyticsvidhya.com/blog/2018/03/introduction-regression-splines-python-codes/\" target=\"_blank\" rel=\"nofollow\">Examples of Regression Splines</a></li>\n<li><a href=\"https://www.youtube.com/watch?v=rtwOrZL02M0\" target=\"_blank\" rel=\"nofollow\">Polynomial Fitting and Splines Video</a></li>\n<li><a href=\"http://www.stat.cmu.edu/~larry/=sml/nonpar.pdf\" target=\"_blank\" rel=\"nofollow\">Nonparametric Regression Notes</a></li>\n<li><a href=\"https://en.wikipedia.org/wiki/Polynomial_regression\" target=\"_blank\" rel=\"nofollow\">Polynomial Regression Wiki</a></li>\n<li><a href=\"https://www.theanalysisfactor.com/regression-modelshow-do-you-know-you-need-a-polynomial/\" target=\"_blank\" rel=\"nofollow\">Polynomial Regression Use-Cases</a></li>\n<li><a href=\"https://discuss.analyticsvidhya.com/t/how-cubic-splines-is-different-from-the-natural-cubic-splines/8259/2\" target=\"_blank\" rel=\"nofollow\">How Cubic Splines are different from Natural Cubic Splines</a></li>\n</ul>"}},"pageContext":{"slug":"ml/nonparametric_regression/spline_regression","previousSlug":"ml/nonparametric_regression/lasso_regression","nextSlug":"ml/nonparametric_regression/smoothing_splines","previousTitle":"Lasso Regression","nextTitle":"Smoothing Splines"}},"staticQueryHashes":[]}