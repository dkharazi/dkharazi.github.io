{"componentChunkName":"component---src-templates-entry-js","path":"/notes/py/socket/makefile","result":{"data":{"markdownRemark":{"frontmatter":{"title":"socket.makefile"},"html":"<h3><code class=\"language-text\">socket.makefile(mode=&#39;r&#39;)</code></h3>\n<ul>\n<li>This function creates and returns a file object <code class=\"language-text\">f</code></li>\n<li>This file object <code class=\"language-text\">f</code> reads from and/or writes to the socket</li>\n<li>Typically, this refers to the server socket</li>\n<li>This can be used for logging</li>\n</ul>\n<h3>Example of <code class=\"language-text\">makefile</code></h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token keyword\">import</span> socket\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> sock <span class=\"token operator\">=</span> socket<span class=\"token punctuation\">(</span>AF_INET<span class=\"token punctuation\">,</span> SOCK_STREAM<span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> serv_addr <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token string\">''</span><span class=\"token punctuation\">,</span> <span class=\"token number\">25000</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># server socket binds...</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> sock<span class=\"token punctuation\">.</span>bind<span class=\"token punctuation\">(</span>serv_address<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># ...to port 25000</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> sock<span class=\"token punctuation\">.</span>listen<span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># only allow 5 client connections</span>\n\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token comment\"># Make file for server socket</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> server<span class=\"token punctuation\">,</span> client_addr <span class=\"token operator\">=</span> sock<span class=\"token punctuation\">.</span>accept<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> sf <span class=\"token operator\">=</span> server<span class=\"token punctuation\">.</span>makefile<span class=\"token punctuation\">(</span><span class=\"token string\">\"r+b\"</span><span class=\"token punctuation\">,</span> bufsize<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token comment\"># Make file for client socket</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> client <span class=\"token operator\">=</span> socket<span class=\"token punctuation\">.</span>create_connection<span class=\"token punctuation\">(</span>serv_addr<span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> cf <span class=\"token operator\">=</span> client<span class=\"token punctuation\">.</span>makefile<span class=\"token punctuation\">(</span><span class=\"token string\">'r_b'</span><span class=\"token punctuation\">,</span> bufsize<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> sf<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span><span class=\"token string\">'hello world'</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> sf<span class=\"token punctuation\">.</span>flush<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> sf<span class=\"token punctuation\">.</span>close<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> server<span class=\"token punctuation\">.</span>close<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>cf<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token number\">99</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># does not hang</span></code></pre></div>\n<h3>References</h3>\n<ul>\n<li><a href=\"http://index-of.co.uk/Python/Python%20Essential%20Reference,%20Fourth%20Edition.pdf\" target=\"_blank\" rel=\"nofollow\">Python Essential Reference</a></li>\n<li><a href=\"https://docs.python.org/3/library/socket.html\" target=\"_blank\" rel=\"nofollow\">Documentation for socket API</a></li>\n<li><a href=\"https://www.arp.com/medias/13916546.pdf\" target=\"_blank\" rel=\"nofollow\">Python in a Nutshell</a></li>\n<li><a href=\"https://stackoverflow.com/a/6947023/12777044\" target=\"_blank\" rel=\"nofollow\">Example of Makefile</a></li>\n</ul>"}},"pageContext":{"slug":"py/socket/makefile","previousSlug":"py/socket/listen","nextSlug":"py/socket/recv","previousTitle":"socket.listen","nextTitle":"socket.recv"}},"staticQueryHashes":[]}